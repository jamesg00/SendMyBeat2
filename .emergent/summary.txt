<analysis>
The AI engineer successfully built SendMyBeat.com, a full-stack application, evolving it from a basic MVP to a feature-rich product. Initial development focused on core functionalities like AI tag generation, description management, and JWT authentication using React, FastAPI, and MongoDB. The project iteratively integrated advanced features such as YouTube video upload with Google OAuth and FFmpeg, a Stripe subscription paywall with credit tracking, and a comprehensive UI redesign. Throughout the process, the engineer demonstrated strong debugging skills by resolving critical issues, including Google OAuth redirect mismatches, Stripe API key loading order, FFmpeg installation, credit decrement logic, and frontend UI synchronization. Significant work was also done on improving the tag generation algorithm to use a hybrid, data-driven approach, and adding user experience features like progress bars and confirmation dialogues.
</analysis>

<product_requirements>
SendMyBeat.com aims to empower music producers by enhancing beat discoverability. The application's core features include:
1.  **AI Tag Generation & Refinement**: Generate advanced, search-optimized tags (now using a sophisticated hybrid pipeline for YouTube discovery) and refine them for better results. Initially, 2 daily generations were free; this was updated to 3, with unlimited access for subscribers.
2.  **Description Management**: Save, manage, and refine custom or AI-generated descriptions as templates, with copy-paste functionality.
3.  **YouTube Integration**: Upload image and audio files (MP3/WAV, now including WEBM) to YouTube with Google OAuth. Supports public, unlisted, private visibility, automatically applying generated tags/descriptions. Free users get 3 daily uploads, subscribers get unlimited.
4.  **Monetization**: Implement Stripe subscriptions for unlimited AI usage and YouTube uploads. Free users have a daily limit of 3 for each. AdSense banners are integrated for free users.
5.  **UI/UX**: Modern design with dark/light mode, collapsible description lists, and a progress bar for long operations. The free tier credit display was redesigned, and confirmation dialogs for deletion and cancel options for ongoing tasks were added.
6.  **Information Pages**: Terms and Conditions, About pages, and a global footer with social media links (Instagram, YouTube, SoundCloud). A Google OAuth explanation for verification was added to the landing page.
</product_requirements>

<key_technical_concepts>
-   **Full-stack**: React, FastAPI, MongoDB.
-   **Authentication**: JWT, Google OAuth 2.0.
-   **AI/LLM**: OpenAI GPT-4o (via Emergent LLM key), sophisticated tag generation pipeline.
-   **Media**: FFmpeg (video creation).
-   **Payments**: Stripe (subscriptions, webhooks).
-   **UI/Styling**: Shadcn UI, Tailwind CSS, Dark/Light mode.
-   **External Integration**: YouTube Data API, Google AdSense.
</key_technical_concepts>

<code_architecture>
The application utilizes a standard full-stack architecture with a React frontend, FastAPI backend, and MongoDB database.



-   **/app/backend/server.py**: The central FastAPI application.
    -   **Summary**: Handles authentication, AI tag/description, YouTube OAuth/upload, and Stripe.
    -   **Changes**: YouTube upload limits increased from 2 to 3. Stripe API key loading order was fixed (load_dotenv before key assignment). Credit decrement logic was ensured for all AI generation and YouTube upload endpoints. Integrated the new  for smarter tag generation. Added  image support for uploads.
-   **/app/backend/ai_tags_pipeline.py**: *New file*.
    -   **Summary**: Implements a sophisticated YouTube tag generation algorithm using live YouTube autocomplete, LLM-generated candidates, template expansion, scoring, and MMR diversity selection to adhere to a 500-character budget.
    -   **Changes**: Initial creation. Adjusted parameters (, ) and candidate pool size to generate 25-40 quality tags. Error handling for undefined 'text' variable in JSON parsing.
-   **/app/frontend/src/App.js**: Main React entry point.
    -   **Summary**: Sets up client-side routing and global state.
    -   **Changes**: Added routes for , , and globally integrated the  component.
-   **/app/frontend/src/pages/LandingPage.js**: Handles login/registration.
    -   **Summary**: User authentication.
    -   **Changes**: Added Google OAuth verification explanation at the bottom of the page.
-   **/app/frontend/src/pages/Dashboard.js**: The primary user interface.
    -   **Summary**: UI for AI tag/description, YouTube upload, credit display, and subscription.
    -   **Changes**: Updated to reflect 3 free daily uses.  now called on success and error for all credit-consuming actions. Integrated  and . Implemented confirmation for description deletion and cancel functionality for tag generation/uploads. Added a Refine Tags button. YouTube upload prompt was changed to Login to connect your YouTube account!.
-   **/app/frontend/src/components/SubscriptionBanner.js**: Displays subscription status and credits.
    -   **Summary**: Informs users about their subscription and credit usage.
    -   **Changes**: Redesigned to show AI and upload credits in separate, side-by-side cards. Displays Unlimited for subscribed users and actual remaining credits for free users (now correctly ). Default values were removed to ensure data integrity.
-   **/app/frontend/src/components/Footer.js**: *New file*.
    -   **Summary**: A global footer with social media links.
    -   **Changes**: Created with Instagram, YouTube, and SoundCloud links. Instagram URL was corrected (removed ).
-   **/app/frontend/src/pages/PrivacyPolicy.js**: Static page for privacy policy.
    -   **Summary**: Provides legal information.
    -   **Changes**: Fixed styling to correctly adapt to dark/light themes and ensured the  properly affected the page's appearance.
-   **/app/frontend/src/components/AdBanner.js**: *New file*.
    -   **Summary**: Placeholder component for Google AdSense ads.
    -   **Changes**: Created to conditionally render ads for free users. Configured to load AdSense script programmatically and use .
-   **/app/frontend/src/components/ProgressBar.js**: *New file*.
    -   **Summary**: A bottom-aligned progress bar.
    -   **Changes**: Created to show progress during tag generation and YouTube uploads, including a cancel button.
-   **/app/frontend/.env**: Frontend environment variables.
    -   **Summary**: Contains .
    -   **Changes**: Added .
-   **/app/frontend/public/index.html**: Main HTML file.
    -   **Summary**: Base structure of the frontend application.
    -   **Changes**: Temporarily removed direct AdSense script to integrate it via  component for better control.
-   **/app/OAUTH_AND_ADSENSE_SETUP.md**: *New file*.
    -   **Summary**: Instructions for setting up Google OAuth redirect URI and AdSense.
    -   **Changes**: Initial creation.
-   **/app/SQUARESPACE_OAUTH_SETUP.md**: *New file*.
    -   **Summary**: Specific instructions for Squarespace OAuth setup.
    -   **Changes**: Initial creation.
</code_architecture>

<pending_tasks>
-   User needs to configure the Google OAuth redirect URI in their Google Cloud Console to match  (or their actual Squarespace domain).
-   User needs to verify that the credit updates for AI generations and YouTube uploads are correctly displayed and decremented on the frontend.
-   User needs to verify the AdSense ads are showing correctly (once in production or with development override).
-   The current work on Stripe subscription display for unlimited usage needs to be resolved.
</pending_tasks>

<current_work>
Immediately preceding this summary, the AI engineer was addressing a critical bug where a newly purchased Stripe subscription was not reflected on the frontend; users still saw 0 remaining credits instead of unlimited. The investigation revealed that while the backend  function's logic appeared correct, a Key Error ( instead of ) prevented a manual query for a user document during debugging. This indicated potential issues in database access or environment variable consistency. After fixing the  reference and manually updating a user's subscription in MongoDB for testing purposes, the engineer's last action was checking the  component on the frontend. The engineer confirmed the 's  prop correctly handles unlimited display but recognized that the underlying issue was likely  not being properly set or updated from the backend's response, leading to the ongoing investigation into response mapping.
</current_work>

<optional_next_step>
Investigate why the  status is not correctly propagating from the backend subscription status endpoint to the frontend's  component.
</optional_next_step>
